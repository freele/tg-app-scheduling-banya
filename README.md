# Баня на даче — Система бронирования

> Для разработчиков: см. [Architecture.md](Architecture.md)

Система бронирования для бани в Португалии. Клиенты бронируют через Telegram, бронирования автоматически синхронизируются с Google Calendar.

---

## Что готово

### Telegram Mini App

Клиенты видят список программ с фотографиями и ценами, выбирают и бронируют через встроенный Calendly.

**4 программы:**

| Программа | Цена | Длительность |
|-----------|------|--------------|
| Аренда бани без пармастера | €340 | 4 часа |
| Программа Бережная баня (с пармастером) | €500 | 4 часа |
| Разовое посещение — женщины | €60 | 4 часа |
| Разовое посещение — мужчины | €60 | 4 часа |

### Админ-панель

- **Управление программами** (`/dashboard/events`)
  - Редактирование названий, описаний, цен
  - Загрузка фотографий
  - Включение/отключение программ

- **Управление бронированиями** (`/dashboard/bookings`)
  - Список всех бронирований
  - Отметка оплаты

### Интеграции

- **Calendly** — управление расписанием и доступностью
- **Google Calendar** — автоматическая синхронизация бронирований
- **Supabase** — база данных и хранение фотографий

---

## Как проверить локально

### 1. Запустить приложения

```bash
pnpm dev
```

### 2. Открыть в браузере

| Приложение | Адрес |
|------------|-------|
| Telegram Mini App | <http://localhost:3000> |
| Админ-панель | <http://localhost:3001> |

### 3. Проверить Telegram Mini App

1. Открыть <http://localhost:3000>
2. Должен появиться список из 4 программ с фотографиями
3. Нажать на любую программу
4. Откроется страница бронирования с Calendly

### 4. Проверить админ-панель

1. Открыть <http://localhost:3001/dashboard/events>
2. Должна появиться таблица с 4 программами
3. Можно редактировать (кнопка "Edit")
4. Можно загружать фото (нажать на квадрат с инициалами)

---

## Управление программами

### Редактирование программы

1. Открыть <http://localhost:3001/dashboard/events>
2. Найти нужную программу в таблице
3. Нажать "Edit"
4. Изменить поля (название, цена, длительность, описание)
5. Нажать "Save"

### Загрузка фотографии

1. В таблице программ найти нужную строку
2. Нажать на цветной квадрат с инициалами (или на "+")
3. Выбрать файл (JPEG, PNG)
4. Фото автоматически уменьшится до 800x600

### Включение/отключение программы

1. В таблице найти программу
2. Нажать кнопку "Active" / "Off"
3. Отключённые программы не показываются в Telegram

---

## Управление бронированиями

### Просмотр бронирований

1. Открыть <http://localhost:3001/dashboard/bookings>
2. Список всех бронирований с фильтрами

### Отметка оплаты

1. Найти бронирование в списке
2. Нажать "Mark Paid" или открыть детали
3. В деталях можно указать сумму и способ оплаты

---

## Calendly

Расписание и доступность настраиваются в Calendly:

- **Calendly**: <https://calendly.com/banya-portugal>
- В админ-панели у каждой программы есть ссылка "Manage" для перехода в настройки Calendly

### Что настраивается в Calendly

- Доступные дни и часы
- Буферное время между бронированиями
- Вопросы для клиентов (телефон, количество гостей)
- Синхронизация с Google Calendar

---

## Полезные команды

```bash
# Запустить локально
pnpm dev

# Освободить порты 3000 и 3001
make free-ports

# Пересобрать проект
pnpm build

# Перезалить фотографии программ
cd apps/admin && node ../../scripts/upload-event-photos.mjs
```

---

## Статус

- [x] Telegram Mini App с программами и фотографиями
- [x] Бронирование через Calendly
- [x] Админ-панель для управления программами
- [x] Загрузка фотографий
- [x] Синхронизация бронирований
- [ ] Деплой на Vercel
- [ ] Подключение Telegram бота в продакшене
